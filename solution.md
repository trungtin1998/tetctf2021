# WEB
## HPNY
- Link tham khảo: https://tsublogs.wordpress.com/2018/12/13/wargame-code-breaking-com-solution/
- Source code:
```html
<!-- Let's pray for new year lucky things <3 -->

<code><span style="color: #000000">
&lt;!--&nbsp;Let's&nbsp;pray&nbsp;for&nbsp;new&nbsp;year&nbsp;lucky&nbsp;things&nbsp;&lt;3&nbsp;--&gt;<br /><br /><span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">get_lucky_word</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$words&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"Chuc&nbsp;mung&nbsp;nam&nbsp;moi"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"gongxifacai"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"happy&nbsp;new&nbsp;year!"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"bonne&nbsp;année"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"Akemashite&nbsp;omedeto&nbsp;gozaimasu"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"Seh&nbsp;heh&nbsp;bok&nbsp;mahn&nbsp;ee&nbsp;bahd&nbsp;euh&nbsp;sae&nbsp;yo"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"kimochi"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"Feliz&nbsp;Año&nbsp;Nuevo"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"S&nbsp;novim&nbsp;godom"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"Gelukkig&nbsp;Nieuwjaar"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"selamat&nbsp;tahun&nbsp;baru"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"iniya&nbsp;puthandu&nbsp;nal&nbsp;Vazhthukkal"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$words</span><span style="color: #007700">[</span><span style="color: #0000BB">array_rand</span><span style="color: #007700">(</span><span style="color: #0000BB">$words</span><span style="color: #007700">)];<br />}<br /><br />function&nbsp;</span><span style="color: #0000BB">get_lucky_number</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$numb&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">rand</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">,</span><span style="color: #0000BB">100</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">strval</span><span style="color: #007700">(</span><span style="color: #0000BB">$numb</span><span style="color: #007700">);<br />}<br /><br /><br />if(!isset(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"roll"</span><span style="color: #007700">]))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">show_source</span><span style="color: #007700">(</span><span style="color: #0000BB">__FILE__</span><span style="color: #007700">);<br />}<br />else<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$wl&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">'/^[a-z\(\)\_\.]+$/i'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"roll"</span><span style="color: #007700">]);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$wl&nbsp;</span><span style="color: #007700">===&nbsp;</span><span style="color: #0000BB">0&nbsp;</span><span style="color: #007700">||&nbsp;</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"roll"</span><span style="color: #007700">])&nbsp;&gt;&nbsp;</span><span style="color: #0000BB">50</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die(</span><span style="color: #DD0000">"bumbadum&nbsp;badum"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;eval(</span><span style="color: #DD0000">"echo&nbsp;"</span><span style="color: #007700">.</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"roll"</span><span style="color: #007700">].</span><span style="color: #DD0000">"();"</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">?&gt;<br /></span><br /><br /></span>
</code>
```
- Đề bài chỉ cho phép sử dụng các kí tự từ 'a' đến 'z', '(', ')', '_' và '.'
- Do phần nội dung được nhập vào được thực thi bởi `eval()` nên có thể bị dính lỗi dạng code/command execution.
- Thử với `system(ls)`:
[./images/Selection_001.png]
